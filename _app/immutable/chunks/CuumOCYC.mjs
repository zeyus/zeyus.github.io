import{g as Ae,j as Ue,h as se,a as I,f as E,s as C,t as Oe}from"./B8MPXtIq.mjs";import"./7STPOpc8.mjs";import{p as de,aF as L,ak as ne,u as Ce,g as f,f as D,a as pe,d as p,aI as Re,c as v,s as R,r as k,t as A,n as M,v as Pe}from"./DEPfPJ3n.mjs";import{i as Ve}from"./D7rpPUoi.mjs";import{i as q}from"./BF8Cdouy.mjs";import{e as De,i as qe}from"./DzpxA3v9.mjs";import{h as H}from"./CJuWatCg.mjs";import{b as G,d as Y}from"./kREDaZmN.mjs";import{b as Ne}from"./WRpJwhuw.mjs";import{B as $e}from"./Co_ojIYE.mjs";var X=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},h;(function(t){t[t.EOS=0]="EOS",t[t.Text=1]="Text",t[t.Incomplete=2]="Incomplete",t[t.ESC=3]="ESC",t[t.Unknown=4]="Unknown",t[t.SGR=5]="SGR",t[t.OSCURL=6]="OSCURL"})(h||(h={}));class je{constructor(){this.VERSION="6.0.6",this.setup_palettes(),this._use_classes=!1,this.bold=!1,this.faint=!1,this.italic=!1,this.underline=!1,this.fg=this.bg=null,this._buffer="",this._url_allowlist={http:1,https:1},this._escape_html=!0,this.boldStyle="font-weight:bold",this.faintStyle="opacity:0.7",this.italicStyle="font-style:italic",this.underlineStyle="text-decoration:underline"}set use_classes(e){this._use_classes=e}get use_classes(){return this._use_classes}set url_allowlist(e){this._url_allowlist=e}get url_allowlist(){return this._url_allowlist}set escape_html(e){this._escape_html=e}get escape_html(){return this._escape_html}set boldStyle(e){this._boldStyle=e}get boldStyle(){return this._boldStyle}set faintStyle(e){this._faintStyle=e}get faintStyle(){return this._faintStyle}set italicStyle(e){this._italicStyle=e}get italicStyle(){return this._italicStyle}set underlineStyle(e){this._underlineStyle=e}get underlineStyle(){return this._underlineStyle}setup_palettes(){this.ansi_colors=[[{rgb:[0,0,0],class_name:"ansi-black"},{rgb:[187,0,0],class_name:"ansi-red"},{rgb:[0,187,0],class_name:"ansi-green"},{rgb:[187,187,0],class_name:"ansi-yellow"},{rgb:[0,0,187],class_name:"ansi-blue"},{rgb:[187,0,187],class_name:"ansi-magenta"},{rgb:[0,187,187],class_name:"ansi-cyan"},{rgb:[255,255,255],class_name:"ansi-white"}],[{rgb:[85,85,85],class_name:"ansi-bright-black"},{rgb:[255,85,85],class_name:"ansi-bright-red"},{rgb:[0,255,0],class_name:"ansi-bright-green"},{rgb:[255,255,85],class_name:"ansi-bright-yellow"},{rgb:[85,85,255],class_name:"ansi-bright-blue"},{rgb:[255,85,255],class_name:"ansi-bright-magenta"},{rgb:[85,255,255],class_name:"ansi-bright-cyan"},{rgb:[255,255,255],class_name:"ansi-bright-white"}]],this.palette_256=[],this.ansi_colors.forEach(i=>{i.forEach(s=>{this.palette_256.push(s)})});let e=[0,95,135,175,215,255];for(let i=0;i<6;++i)for(let s=0;s<6;++s)for(let a=0;a<6;++a){let l={rgb:[e[i],e[s],e[a]],class_name:"truecolor"};this.palette_256.push(l)}let r=8;for(let i=0;i<24;++i,r+=10){let s={rgb:[r,r,r],class_name:"truecolor"};this.palette_256.push(s)}}escape_txt_for_html(e){return this._escape_html?e.replace(/[&<>"']/gm,r=>{if(r==="&")return"&amp;";if(r==="<")return"&lt;";if(r===">")return"&gt;";if(r==='"')return"&quot;";if(r==="'")return"&#x27;"}):e}append_buffer(e){var r=this._buffer+e;this._buffer=r}get_next_packet(){var e={kind:h.EOS,text:"",url:""},r=this._buffer.length;if(r==0)return e;var i=this._buffer.indexOf("\x1B");if(i==-1)return e.kind=h.Text,e.text=this._buffer,this._buffer="",e;if(i>0)return e.kind=h.Text,e.text=this._buffer.slice(0,i),this._buffer=this._buffer.slice(i),e;if(i==0){if(r<3)return e.kind=h.Incomplete,e;var s=this._buffer.charAt(1);if(s!="["&&s!="]"&&s!="(")return e.kind=h.ESC,e.text=this._buffer.slice(0,1),this._buffer=this._buffer.slice(1),e;if(s=="["){this._csi_regex||(this._csi_regex=ae(oe||(oe=X([`
                        ^                           # beginning of line
                                                    #
                                                    # First attempt
                        (?:                         # legal sequence
                          \x1B[                      # CSI
                          ([<-?]?)              # private-mode char
                          ([d;]*)                    # any digits or semicolons
                          ([ -/]?               # an intermediate modifier
                          [@-~])                # the command
                        )
                        |                           # alternate (second attempt)
                        (?:                         # illegal sequence
                          \x1B[                      # CSI
                          [ -~]*                # anything legal
                          ([\0-:])              # anything illegal
                        )
                    `],[`
                        ^                           # beginning of line
                                                    #
                                                    # First attempt
                        (?:                         # legal sequence
                          \\x1b\\[                      # CSI
                          ([\\x3c-\\x3f]?)              # private-mode char
                          ([\\d;]*)                    # any digits or semicolons
                          ([\\x20-\\x2f]?               # an intermediate modifier
                          [\\x40-\\x7e])                # the command
                        )
                        |                           # alternate (second attempt)
                        (?:                         # illegal sequence
                          \\x1b\\[                      # CSI
                          [\\x20-\\x7e]*                # anything legal
                          ([\\x00-\\x1f:])              # anything illegal
                        )
                    `]))));let l=this._buffer.match(this._csi_regex);if(l===null)return e.kind=h.Incomplete,e;if(l[4])return e.kind=h.ESC,e.text=this._buffer.slice(0,1),this._buffer=this._buffer.slice(1),e;l[1]!=""||l[3]!="m"?e.kind=h.Unknown:e.kind=h.SGR,e.text=l[2];var a=l[0].length;return this._buffer=this._buffer.slice(a),e}else if(s=="]"){if(r<4)return e.kind=h.Incomplete,e;if(this._buffer.charAt(2)!="8"||this._buffer.charAt(3)!=";")return e.kind=h.ESC,e.text=this._buffer.slice(0,1),this._buffer=this._buffer.slice(1),e;this._osc_st||(this._osc_st=Fe(le||(le=X([`
                        (?:                         # legal sequence
                          (\x1B\\)                    # ESC                           |                           # alternate
                          (\x07)                      # BEL (what xterm did)
                        )
                        |                           # alternate (second attempt)
                        (                           # illegal sequence
                          [\0-]                 # anything illegal
                          |                           # alternate
                          [\b-]                 # anything illegal
                          |                           # alternate
                          [-]                 # anything illegal
                        )
                    `],[`
                        (?:                         # legal sequence
                          (\\x1b\\\\)                    # ESC \\
                          |                           # alternate
                          (\\x07)                      # BEL (what xterm did)
                        )
                        |                           # alternate (second attempt)
                        (                           # illegal sequence
                          [\\x00-\\x06]                 # anything illegal
                          |                           # alternate
                          [\\x08-\\x1a]                 # anything illegal
                          |                           # alternate
                          [\\x1c-\\x1f]                 # anything illegal
                        )
                    `])))),this._osc_st.lastIndex=0;{let c=this._osc_st.exec(this._buffer);if(c===null)return e.kind=h.Incomplete,e;if(c[3])return e.kind=h.ESC,e.text=this._buffer.slice(0,1),this._buffer=this._buffer.slice(1),e}{let c=this._osc_st.exec(this._buffer);if(c===null)return e.kind=h.Incomplete,e;if(c[3])return e.kind=h.ESC,e.text=this._buffer.slice(0,1),this._buffer=this._buffer.slice(1),e}this._osc_regex||(this._osc_regex=ae(ue||(ue=X([`
                        ^                           # beginning of line
                                                    #
                        \x1B]8;                    # OSC Hyperlink
                        [ -:<-~]*       # params (excluding ;)
                        ;                           # end of params
                        ([!-~]{0,512})        # URL capture
                        (?:                         # ST
                          (?:\x1B\\)                  # ESC                           |                           # alternate
                          (?:\x07)                    # BEL (what xterm did)
                        )
                        ([ -~]+)              # TEXT capture
                        \x1B]8;;                   # OSC Hyperlink End
                        (?:                         # ST
                          (?:\x1B\\)                  # ESC                           |                           # alternate
                          (?:\x07)                    # BEL (what xterm did)
                        )
                    `],[`
                        ^                           # beginning of line
                                                    #
                        \\x1b\\]8;                    # OSC Hyperlink
                        [\\x20-\\x3a\\x3c-\\x7e]*       # params (excluding ;)
                        ;                           # end of params
                        ([\\x21-\\x7e]{0,512})        # URL capture
                        (?:                         # ST
                          (?:\\x1b\\\\)                  # ESC \\
                          |                           # alternate
                          (?:\\x07)                    # BEL (what xterm did)
                        )
                        ([\\x20-\\x7e]+)              # TEXT capture
                        \\x1b\\]8;;                   # OSC Hyperlink End
                        (?:                         # ST
                          (?:\\x1b\\\\)                  # ESC \\
                          |                           # alternate
                          (?:\\x07)                    # BEL (what xterm did)
                        )
                    `]))));let l=this._buffer.match(this._osc_regex);if(l===null)return e.kind=h.ESC,e.text=this._buffer.slice(0,1),this._buffer=this._buffer.slice(1),e;e.kind=h.OSCURL,e.url=l[1],e.text=l[2];var a=l[0].length;return this._buffer=this._buffer.slice(a),e}else if(s=="(")return e.kind=h.Unknown,this._buffer=this._buffer.slice(3),e}}ansi_to_html(e){this.append_buffer(e);for(var r=[];;){var i=this.get_next_packet();if(i.kind==h.EOS||i.kind==h.Incomplete)break;i.kind==h.ESC||i.kind==h.Unknown||(i.kind==h.Text?r.push(this.transform_to_html(this.with_state(i))):i.kind==h.SGR?this.process_ansi(i):i.kind==h.OSCURL&&r.push(this.process_hyperlink(i)))}return r.join("")}with_state(e){return{bold:this.bold,faint:this.faint,italic:this.italic,underline:this.underline,fg:this.fg,bg:this.bg,text:e.text}}process_ansi(e){let r=e.text.split(";");for(;r.length>0;){let i=r.shift(),s=parseInt(i,10);if(isNaN(s)||s===0)this.fg=null,this.bg=null,this.bold=!1,this.faint=!1,this.italic=!1,this.underline=!1;else if(s===1)this.bold=!0;else if(s===2)this.faint=!0;else if(s===3)this.italic=!0;else if(s===4)this.underline=!0;else if(s===21)this.bold=!1;else if(s===22)this.faint=!1,this.bold=!1;else if(s===23)this.italic=!1;else if(s===24)this.underline=!1;else if(s===39)this.fg=null;else if(s===49)this.bg=null;else if(s>=30&&s<38)this.fg=this.ansi_colors[0][s-30];else if(s>=40&&s<48)this.bg=this.ansi_colors[0][s-40];else if(s>=90&&s<98)this.fg=this.ansi_colors[1][s-90];else if(s>=100&&s<108)this.bg=this.ansi_colors[1][s-100];else if((s===38||s===48)&&r.length>0){let a=s===38,l=r.shift();if(l==="5"&&r.length>0){let d=parseInt(r.shift(),10);d>=0&&d<=255&&(a?this.fg=this.palette_256[d]:this.bg=this.palette_256[d])}if(l==="2"&&r.length>2){let d=parseInt(r.shift(),10),c=parseInt(r.shift(),10),x=parseInt(r.shift(),10);if(d>=0&&d<=255&&c>=0&&c<=255&&x>=0&&x<=255){let g={rgb:[d,c,x],class_name:"truecolor"};a?this.fg=g:this.bg=g}}}}}transform_to_html(e){let r=e.text;if(r.length===0||(r=this.escape_txt_for_html(r),!e.bold&&!e.italic&&!e.faint&&!e.underline&&e.fg===null&&e.bg===null))return r;let i=[],s=[],a=e.fg,l=e.bg;e.bold&&i.push(this._boldStyle),e.faint&&i.push(this._faintStyle),e.italic&&i.push(this._italicStyle),e.underline&&i.push(this._underlineStyle),this._use_classes?(a&&(a.class_name!=="truecolor"?s.push(`${a.class_name}-fg`):i.push(`color:rgb(${a.rgb.join(",")})`)),l&&(l.class_name!=="truecolor"?s.push(`${l.class_name}-bg`):i.push(`background-color:rgb(${l.rgb.join(",")})`))):(a&&i.push(`color:rgb(${a.rgb.join(",")})`),l&&i.push(`background-color:rgb(${l.rgb})`));let d="",c="";return s.length&&(d=` class="${s.join(" ")}"`),i.length&&(c=` style="${i.join(";")}"`),`<span${c}${d}>${r}</span>`}process_hyperlink(e){let r=e.url.split(":");return r.length<1||!this._url_allowlist[r[0]]?"":`<a href="${this.escape_txt_for_html(e.url)}">${this.escape_txt_for_html(e.text)}</a>`}}function ae(t,...e){let r=t.raw[0],i=/^\s+|\s+\n|\s*#[\s\S]*?\n|\n/gm,s=r.replace(i,"");return new RegExp(s)}function Fe(t,...e){let r=t.raw[0],i=/^\s+|\s+\n|\s*#[\s\S]*?\n|\n/gm,s=r.replace(i,"");return new RegExp(s,"g")}var oe,le,ue;const ze=32,We=34,Me=35,fe=255,He=8,Ge="none",Ye=1,Xe=[16,8,7,6,5],Qe=[1,2],Je=["none","even","odd"],Ze=["none","odd","even"],Ke=[1,1.5,2],Q={protocol:0,usbControlInterfaceClass:2,usbTransferInterfaceClass:10};function ce(t,e){const r=t.configurations[0];for(const i of r.interfaces)if(i.alternates[0].interfaceClass===e)return i;throw new TypeError(`Unable to find interface with class ${e}.`)}function he(t,e){const r=t.alternates[0];for(const i of r.endpoints)if(i.direction==e)return i;throw new TypeError(`Interface ${t.interfaceNumber} does not have an ${e} endpoint.`)}class et{device_;endpoint_;onError_;type;constructor(e,r,i){this.type="bytes",this.device_=e,this.endpoint_=r,this.onError_=i}pull(e){(async()=>{let r;if(e.desiredSize){const i=e.desiredSize/this.endpoint_.packetSize;r=Math.ceil(i)*this.endpoint_.packetSize}else r=this.endpoint_.packetSize;try{const i=await this.device_.transferIn(this.endpoint_.endpointNumber,r);if(i.status!="ok"&&(e.error(`USB error: ${i.status}`),this.onError_()),i.data?.buffer){const s=new Uint8Array(i.data.buffer,i.data.byteOffset,i.data.byteLength);e.enqueue(s)}}catch(i){e.error(i.toString()),this.onError_()}})()}}class tt{device_;endpoint_;onError_;constructor(e,r,i){this.device_=e,this.endpoint_=r,this.onError_=i}async write(e,r){try{const i=await this.device_.transferOut(this.endpoint_.endpointNumber,e);i.status!="ok"&&(r.error(i.status),this.onError_())}catch(i){r.error(i.toString()),this.onError_()}}}let J=class{polyfillOptions_;device_;controlInterface_;transferInterface_;inEndpoint_;outEndpoint_;serialOptions_;readable_;writable_;outputSignals_;constructor(e,r){this.polyfillOptions_={...Q,...r},this.outputSignals_={dataTerminalReady:!1,requestToSend:!1,break:!1},this.device_=e,this.controlInterface_=ce(this.device_,this.polyfillOptions_.usbControlInterfaceClass),this.transferInterface_=ce(this.device_,this.polyfillOptions_.usbTransferInterfaceClass),this.inEndpoint_=he(this.transferInterface_,"in"),this.outEndpoint_=he(this.transferInterface_,"out"),this.readable_=null,this.writable_=null,this.serialOptions_={baudRate:9600}}get readable(){return!this.readable_&&this.device_.opened&&(this.readable_=new ReadableStream(new et(this.device_,this.inEndpoint_,()=>{this.readable_=null}),{highWaterMark:this.serialOptions_.bufferSize??fe})),this.readable_}get writable(){return!this.writable_&&this.device_.opened&&(this.writable_=new WritableStream(new tt(this.device_,this.outEndpoint_,()=>{this.writable_=null}),new ByteLengthQueuingStrategy({highWaterMark:this.serialOptions_.bufferSize??fe}))),this.writable_}async open(e){this.serialOptions_=e,this.validateOptions();try{await this.device_.open(),this.device_.configuration===null&&await this.device_.selectConfiguration(1),await this.device_.claimInterface(this.controlInterface_.interfaceNumber),this.controlInterface_!==this.transferInterface_&&await this.device_.claimInterface(this.transferInterface_.interfaceNumber),await this.setLineCoding(),await this.setSignals({dataTerminalReady:!0})}catch(r){throw this.device_.opened&&await this.device_.close(),new Error("Error setting up device: "+r.toString())}}async close(){const e=[];this.readable_&&e.push(this.readable_.cancel()),this.writable_&&e.push(this.writable_.abort()),await Promise.all(e),this.readable_=null,this.writable_=null,this.device_.opened&&(await this.setSignals({dataTerminalReady:!1,requestToSend:!1}),await this.device_.close())}async forget(){return this.device_.forget()}getInfo(){return{usbVendorId:this.device_.vendorId,usbProductId:this.device_.productId}}reconfigure(e){return this.serialOptions_={...this.serialOptions_,...e},this.validateOptions(),this.setLineCoding()}async setSignals(e){if(this.outputSignals_={...this.outputSignals_,...e},e.dataTerminalReady!==void 0||e.requestToSend!==void 0){const r=(this.outputSignals_.dataTerminalReady?1:0)|(this.outputSignals_.requestToSend?2:0);await this.device_.controlTransferOut({requestType:"class",recipient:"interface",request:We,value:r,index:this.controlInterface_.interfaceNumber})}if(e.break!==void 0){const r=this.outputSignals_.break?65535:0;await this.device_.controlTransferOut({requestType:"class",recipient:"interface",request:Me,value:r,index:this.controlInterface_.interfaceNumber})}}validateOptions(){if(!this.isValidBaudRate(this.serialOptions_.baudRate))throw new RangeError("invalid Baud Rate "+this.serialOptions_.baudRate);if(!this.isValidDataBits(this.serialOptions_.dataBits))throw new RangeError("invalid dataBits "+this.serialOptions_.dataBits);if(!this.isValidStopBits(this.serialOptions_.stopBits))throw new RangeError("invalid stopBits "+this.serialOptions_.stopBits);if(!this.isValidParity(this.serialOptions_.parity))throw new RangeError("invalid parity "+this.serialOptions_.parity)}isValidBaudRate(e){return e%1===0}isValidDataBits(e){return typeof e>"u"?!0:Xe.includes(e)}isValidStopBits(e){return typeof e>"u"?!0:Qe.includes(e)}isValidParity(e){return typeof e>"u"?!0:Je.includes(e)}async setLineCoding(){const e=new ArrayBuffer(7),r=new DataView(e);if(r.setUint32(0,this.serialOptions_.baudRate,!0),r.setUint8(4,Ke.indexOf(this.serialOptions_.stopBits??Ye)),r.setUint8(5,Ze.indexOf(this.serialOptions_.parity??Ge)),r.setUint8(6,this.serialOptions_.dataBits??He),(await this.device_.controlTransferOut({requestType:"class",recipient:"interface",request:ze,value:0,index:this.controlInterface_.interfaceNumber},e)).status!="ok")throw new DOMException("NetworkError","Failed to set line coding.")}};class rt{async requestPort(e,r){r={...Q,...r};const i=[];if(e&&e.filters)for(const l of e.filters){const d={classCode:r.usbControlInterfaceClass};l.usbVendorId!==void 0&&(d.vendorId=l.usbVendorId),l.usbProductId!==void 0&&(d.productId=l.usbProductId),i.push(d)}i.length===0&&i.push({classCode:r.usbControlInterfaceClass});const s=await navigator.usb.requestDevice({filters:i});return new J(s,r)}async getPorts(e){e={...Q,...e};const r=await navigator.usb.getDevices(),i=[];return r.forEach(s=>{try{const a=new J(s,e);i.push(a)}catch{}}),i}}const be=new rt;function T(t,e,r,i,s){ArrayBuffer.isView(t)&&(e+=t.byteOffset,t=t.buffer),ArrayBuffer.isView(r)&&(i+=r.byteOffset,r=r.buffer);const a=new Uint8Array(t,e,s),l=new Uint8Array(r,i,s);a.set(l)}let $=[];async function j(){try{"serial"in navigator?$=await navigator.serial.getPorts():"usb"in navigator&&($=await be.getPorts())}catch(t){console.warn("Unable to get previously used serial ports:",t.message)}}j();const N=function(){return $},it=function(){try{return new st}catch(t){return console.warn(t.message),null}},st=class{options;port;reader;writer;keepReading;inBuf;inLen;textEncoder;textDecoder;constructor(){if(this.options={baudRate:9600},this.port=null,this.reader=null,this.keepReading=!0,this.inBuf=new ArrayBuffer(1024*1024),this.inLen=0,this.textEncoder=new TextEncoder,this.textDecoder=new TextDecoder,!("serial"in navigator))if("usb"in navigator)console.log("Using WebUSB polyfill for WebSerial");else throw new Error("WebSerial is not supported in your browser (try Chrome or Edge)")}available(){const t=new Uint8Array(this.inBuf,0,this.inLen);let e=0;for(let r=0;r<t.length;r++){const i=t[r];(i>>7==0||i>>5==6&&r<t.length-1||i>>4==14&&r<t.length-2||i>>3==30&&r<t.length-3)&&e++}return e}availableBytes(){return this.inLen}bufferSize(t){if(t!=this.inBuf.byteLength){const e=new ArrayBuffer(t),r=Math.min(this.inLen,t);T(e,0,this.inBuf,this.inLen-r,r),this.inBuf=e,this.inLen=r}}clear(){this.inLen=0}close(){this.reader?(this.keepReading=!1,this.reader.cancel()):console.log("Serial port is already closed")}async dtr(t){if(t===void 0)throw new Error("Pass either true or false to dtr() to turn the Data Terminal Ready signal on or off");t?await this.port?.setSignals({dataTerminalReady:!0}):await this.port?.setSignals({dataTerminalReady:!1})}isSerialPort(t){return typeof SerialPort<"u"&&t instanceof SerialPort||t instanceof J}last(){if(!this.inLen)return"";const t=new Uint8Array(this.inBuf,0,this.inLen);let e=null,r=null;for(let i=t.length-1;0<=i;i--){const s=t[i];if(s>>7==0){e=i,r=1;break}else if(s>>5==6&&i<t.length-1){e=i,r=2;break}else if(s>>4==14&&i<t.length-2){e=i,r=3;break}else if(s>>3==30&&i<t.length-3){e=i,r=4;break}}if(e!==null&&r!==null){const i=new Uint8Array(this.inBuf,e,r),s=this.textDecoder.decode(i);return e+r<this.inLen&&T(this.inBuf,0,this.inBuf,e+r,this.inLen-r-e),this.inLen-=e+r,s}else return""}lastByte(){if(this.inLen){const t=new Uint8Array(this.inBuf,this.inLen-1,1);return this.inLen=0,t[0]}else return null}async open(...t){await this.selectPort(...t)}opened(){return this.port!==null&&this.isSerialPort(this.port)&&this.port.readable!==null}presets={Adafruit:[{usbVendorId:9114}],Arduino:[{usbVendorId:1003,usbProductId:8465},{usbVendorId:1003,usbProductId:8535},{usbVendorId:4292,usbProductId:60016},{usbVendorId:6991},{usbVendorId:9025},{usbVendorId:9114},{usbVendorId:10755},{usbVendorId:13123,usbProductId:67}],MicroPython:[{usbVendorId:1027,usbProductId:24577},{usbVendorId:1027,usbProductId:24592},{usbVendorId:1027,usbProductId:24593},{usbVendorId:1027,usbProductId:24596},{usbVendorId:1027,usbProductId:24597},{usbVendorId:1027,usbProductId:24604},{usbVendorId:1684,usbProductId:9},{usbVendorId:3368,usbProductId:516},{usbVendorId:4292,usbProductId:6e4},{usbVendorId:6790,usbProductId:29987},{usbVendorId:11914,usbProductId:5},{usbVendorId:61525,usbProductId:38912}],RaspberryPi:[{usbVendorId:11914}]};read(t=this.inLen){if(!this.inLen||!t)return"";const e=new Uint8Array(this.inBuf,0,this.inLen);let r=0,i=null,s=null,a=0;for(let l=0;l<e.length;l++){const d=e[l];let c;if(d>>7==0?(c=!0,r=0):d>>5==6?(c=!0,r=1):d>>4==14?(c=!0,r=2):d>>3==30?(c=!0,r=3):(c=!1,r--),i===null&&c&&(i=l),i!==null&&r<=0&&(a++,s=l-i+1),t<=a)break}if(i!==null&&s!==null){const l=new Uint8Array(this.inBuf,i,s),d=this.textDecoder.decode(l);return i+s<this.inLen&&T(this.inBuf,0,this.inBuf,i+s,this.inLen-s-i),this.inLen-=i+s,d}else return""}readUntil(t){let e=this.readArrayBufferUntil(t),r=null;for(let i=0;i<e.length;i++){const s=e[i];if(s>>7==0){r=i;break}else if(s>>5==6){r=i;break}else if(s>>4==14){r=i;break}else if(s>>3==30){r=i;break}}return r!==null?(0<r&&(e=new Uint8Array(e.buffer,e.byteOffset+r,e.length-r)),this.textDecoder.decode(e)):""}readArrayBuffer(t=this.inLen){if(this.inLen&&t){t=Math.min(t,this.inLen);const e=new Uint8Array(this.inBuf,0,t),r=new Uint8Array(e);return t<this.inLen&&T(this.inBuf,0,this.inBuf,t,this.inLen-t),this.inLen-=t,r}else return new Uint8Array([])}readArrayBufferUntil(t){if(typeof t=="string")t=this.textEncoder.encode(t);else if(typeof t=="number"&&Number.isInteger(t)){if(t<0||255<t)throw new TypeError("readArrayBufferUntil expects as an argument an integer between 0 to 255");t=new Uint8Array([t])}else if(Array.isArray(t)){for(let i=0;i<t.length;i++)if(typeof t[i]!="number"||!Number.isInteger(t[i])||t[i]<0||255<t[i])throw new TypeError("Array contained a value that wasn't an integer, or outside of 0 to 255");t=new Uint8Array(t)}else if(!(t instanceof Uint8Array))throw new TypeError("Supported types are: String, Integer number (0 to 255), Array of integer numbers (0 to 255), Uint8Array");if(!this.inLen||!t.length)return new Uint8Array([]);const e=new Uint8Array(this.inBuf,0,this.inLen);let r=0;for(let i=0;i<e.length;i++)if(e[i]===t[r]?r++:r=0,r==t.length){const s=new Uint8Array(this.inBuf,0,i+1),a=new Uint8Array(s);return i+1<this.inLen&&T(this.inBuf,0,this.inBuf,i+1,this.inLen-i-1),this.inLen-=i+1,a}return new Uint8Array([])}readByte(){const t=this.readArrayBuffer(1);return t.length?t[0]:null}readBytes(t=this.inLen){const e=this.readArrayBuffer(t),r=[];for(let i=0;i<e.length;i++)r.push(e[i]);return r}readBytesUntil(t){const e=this.readArrayBufferUntil(t),r=[];for(let i=0;i<e.length;i++)r.push(e[i]);return r}async rts(t){if(t===void 0)throw new Error("Pass either true or false to rts() to turn the Request To Send signal on or off");t?await this.port?.setSignals({requestToSend:!0}):await this.port?.setSignals({requestToSend:!1})}async selectPort(...t){let e=[];if(1<=t.length)if(Array.isArray(t[0]))e=t[0];else if(this.isSerialPort(t[0]))this.port=t[0],e=null;else if(typeof t[0]=="object")e=[t[0]];else if(typeof t[0]=="string"){const r=t[0];if(r in this.presets)e=this.presets[r];else throw new TypeError('Unrecognized preset "'+r+'", available: '+Object.keys(this.presets).join(", "))}else if(typeof t[0]=="number")this.options.baudRate=t[0];else throw new TypeError('Unexpected first argument "'+t[0]+'"');if(2<=t.length)if(typeof t[1]=="object")this.options=t[1];else if(typeof t[1]=="number")this.options.baudRate=t[1];else throw new TypeError('Unexpected second argument "'+t[1]+'"');try{e&&("serial"in navigator?this.port=await navigator.serial.requestPort({filters:e}):"usb"in navigator&&(this.port=await be.requestPort({filters:e})))}catch(r){console.warn(r.message),this.port=null}}async start(t){if(!this.port){console.error("No serial port selected.");return}try{await this.port.open(this.options),console.log("Connected to serial port"),this.keepReading=!0}catch(e){let r=e.message;throw r.includes("already open")&&(r+=" (the port may be open in another program, please try refreshing the tab)"),console.error(r),e}for(;this.port.readable&&this.keepReading;){this.reader=this.port.readable.getReader(),this.writer=this.port.writable?.getWriter();try{for(;;){let{value:e,done:r}=await this.reader.read();if(r){await this.writer?.ready,this.writer?.releaseLock(),this.reader.releaseLock();break}e&&(this.inBuf.byteLength<e.length&&(e=new Uint8Array(e.buffer,e.byteOffset+e.length-this.inBuf.byteLength,this.inBuf.byteLength)),this.inBuf.byteLength<this.inLen+e.length&&(T(this.inBuf,0,this.inBuf,this.inLen+e.length-this.inBuf.byteLength,this.inBuf.byteLength-e.length),console.warn("Discarding the oldest "+(this.inLen+e.length-this.inBuf.byteLength)+" bytes of serial input data (you might want to read more frequently or increase the buffer via bufferSize())"),this.inLen-=this.inLen+e.length-this.inBuf.byteLength),T(this.inBuf,this.inLen,e,0,e.length),this.inLen+=e.length,t&&t(this.read()))}}catch(e){this.reader.releaseLock(),console.warn(e.message)}}this.port.close(),this.reader=null,console.log("Disconnected from serial port")}async forget(){j(),this.port&&(console.log("Forgetting current serial port"),this.close(),this.port=null);for(let t of $){console.log(t);try{await t.close()}catch(e){console.warn(e.message)}await t.forget()}}async write(t){let e;if(typeof t=="string")e=this.textEncoder.encode(t);else if(typeof t=="number"&&Number.isInteger(t)){if(t<0||255<t)throw new TypeError("Write expects a number between 0 and 255 for sending it as a byte. To send any number as a sequence of digits instead, first convert it to a string before passing it to write().");e=new Uint8Array([t])}else if(Array.isArray(t)){for(let r=0;r<t.length;r++)if(typeof t[r]!="number"||!Number.isInteger(t[r])||t[r]<0||255<t[r])throw new TypeError("Array contained a value that wasn't an integer, or outside of 0 to 255");e=new Uint8Array(t)}else if(t instanceof ArrayBuffer||ArrayBuffer.isView(t))e=t;else throw new TypeError("Supported types are: String, Integer number (0 to 255), Array of integer numbers (0 to 255), ArrayBuffer, TypedArray or DataView");return!this.port||!this.port.writable?(console.warn("Serial port is not open, ignoring write"),!1):(await this.writer?.ready,await this.writer?.write(e),!0)}};var nt=E("<pre><!></pre>"),at=E('<pre class="output svelte-k4so18"> </pre>'),ot=E("<pre> </pre>"),lt=E('<span class="prompt svelte-k4so18"><!></span> <pre> </pre>',1),ut=E('<div class="terminal-line svelte-k4so18"><!></div>'),ft=E('<span class="prompt svelte-k4so18"><!></span>'),ct=E('<pre class="input svelte-k4so18"> </pre> <span class="cursor svelte-k4so18"></span>',1),ht=E('<pre class="input svelte-k4so18"> </pre> <span class="cursor svelte-k4so18"></span>',1),dt=E('<div class="terminal svelte-k4so18" id="terminal-wrapper"><!> <div class="terminal-line svelte-k4so18"><!> <textarea autocomplete="off" spellcheck="false" autocapitalize="off" name="mobileinput" id="touchinput" class="svelte-k4so18"></textarea> <!></div></div> <!>',1);function pt(t,e){de(e,!0);const r=new je,i="anon@zeyus&gt;";let s=L(ne([]));function a(u,o){p(s,[...f(s),{text:u,type:o}],!0)}a(`            __________                                 
         .'----------\`.                              
         | .--------. |                             
         | |########| |       __________              
         | |########| |      /__________             
.--------| \`--------' |------|    --=-- |-------------.
|        \`----,-.-----'      |o ======  |             | 
|       ______|_|_______     |__________|             | 
|      /  %%%%%%%%%%%%  \\                             | 
|     /  %%%%%%%%%%%%%%  \\                            | 
|     ^^^^^^^^^^^^^^^^^^^^                            | 
+-----------------------------------------------------+`,"output"),a(`
`,"output"),a(`WARNING:  Unauthorized access to this system is
forbidden and will be prosecuted by law. By accessing
this system, you agree that your actions may be
monitored if unauthorized usage is suspected.`,"output"),a(`
`,"output"),a('Type "help" for a list of commands.',"output"),a(`
`,"output");let l=L(""),d=L(null),c=L(!1),x,g=L("");const S=it()||null;function F(u){u.preventDefault();const o=document.getElementById("touchinput");if(f(c)){me(u);return}o&&(u.key==="Enter"?(p(s,[...f(s),{text:f(l),type:"input"}],!0),ve(f(l)),p(l,""),o.value="",setTimeout(()=>{x.scrollTop=x.scrollHeight},0)):u.key==="Backspace"?p(l,f(l).slice(0,-1),!0):u.key.length===1&&p(l,f(l)+u.key))}function _e(u){const o=u.target;if(p(l,o.value,!0),f(c)){ye(f(l));return}if(f(l).includes("\r")||f(l).includes(`
`)){if(typeof KeyboardEvent>"u")return;F(new KeyboardEvent("keydown",{key:"Enter"}))}}function ge(u,o=25){if(!(typeof KeyboardEvent>"u")){for(let n=0;n<u.length;n++)setTimeout(()=>{p(l,f(l)+u[n])},o*n);setTimeout(()=>{F(new KeyboardEvent("keydown",{key:"Enter"}))},o*u.length)}}async function ye(u){await Z(u)}async function me(u){const o=u.key;if(o==="Control"||o==="Shift"||o==="Alt"||o==="Meta")return;let n,_=!1;switch(o){case"Enter":_=!0,n=`
`,a(f(g),"serial"),p(g,"");break;case"Backspace":n="\b";break;case"Escape":f(d)!==null&&(p(c,!1),S?.close());return;default:if(u.ctrlKey)switch(_=!0,o){case"@":n="\0";break;case"a":n="";break;case"b":n="";break;case"c":n="";break;case"d":n="";break;case"e":n="";break;case"f":n="";break;case"g":n="\x07";break;case"h":n="\b";break;case"i":n="	";break;case"j":n=`
`;break;case"k":n="\v";break;case"l":n="\f";break;case"m":n="\r";break;case"n":n="";break;case"o":n="";break;case"p":n="";break;case"q":n="";break;case"r":n="";break;case"s":n="";break;case"t":n="";break;case"u":n="";break;case"v":n="";break;case"w":n="";break;case"x":n="";break;case"y":n="";break;case"z":n="";break;case"[":n="\x1B";break;case"\\":n="";break;case"]":n="";break;case"^":n="";break;case"_":n="";break;case"?":n="";break;default:return}else{n=o;break}}await Z(n,_)}async function Z(u,o=!1){o||p(g,f(g)+u),S?.write(u)}async function we(u){const o=u.split(`
`);if(o.length===1){p(g,f(g)+o[0]);return}for(let n=0;n<o.length;n++){const _=o[n];p(g,f(g)+_),a(_,"serial"),p(g,"")}}function ve(u){u=u.trim().replace(/\s+/g," ");const o=u.split(" "),n=o[0];switch(n){case"echo":const _=o.slice(1).join(" "),z=r.ansi_to_html(_.replace(/\\033/g,"\x1B").replace(/\\e/g,"\x1B").replace(/\\n/g,`
`).replace(/\\t/g,"	").replace(/\\r/g,"\r").replace(/\\b/g,"\b").replace(/\\f/g,"\f").replace(/\\v/g,"\v").replace(/\\0/g,"\0").replace(/\\x1b/g,"\x1B"));a(z,"output");break;case"clear":p(s,[],!0);break;case"help":a("Commands: echo, clear, help, serial","output");break;case"serial":if(!S){a("Uh, uh uh! You didn't say the magic word!","error"),a(":( Unfortunately serial not supported in this browser","error"),a("You need a browser that supports Web Serial API or the USB API","error");break}if(o.length<2){a("Serial commands: list, open, close, forget","output");break}const P=o[1];switch(P){case"list":a("Listing serial ports...","output"),p(U,N(),!0),f(U).forEach((w,B)=>{a("Allowed port "+B.toString(),"serial")}),f(U).length===0&&a('No serial ports permitted, to use them from your browser please request them using "serial open ..."',"serial");break;case"open":if(o.length<7){a(`Usage: serial open BAUD_RATE DATA_BITS STOP_BITS PARITY FLOW_CONTROL
BAUD_RATE: The baud rate to use (default: 9600)
DATA_BITS: The number of data bits (default: 8)
STOP_BITS: The number of stop bits (default: 1)
PARITY: The parity to use (default: none)
FLOW_CONTROL: The flow control to use (default: none)
Example: serial open 9600 8 1 none none`,"output");break}const V=parseInt(o[2]),W=parseInt(o[3]),y=parseInt(o[4]),b=o[5],m=o[6];S.open(V).then(()=>{const w=S.port;if(w===null){a("No serial ports available","error");return}j().then(()=>{p(U,N(),!0),p(d,N().indexOf(w),!0)}),a("Opening serial port, to exit press Escape...","serial"),p(c,!0),p(g,""),S.selectPort(w,{baudRate:V,dataBits:W,stopBits:y,parity:b,flowControl:m}).then(()=>{S.start(we).then(()=>{p(c,!1),a("Serial port closed","serial")}).catch(B=>{p(c,!1),a(`Error starting serial port: ${B}`,"error"),a("Try refreshing the browser tab or ensuring the port is not used by another program.","error")})}).catch(B=>{p(c,!1),a(`Error opening serial port: ${B}`,"error")})}).catch(w=>{a(`Error opening serial port: ${w}`,"error")});break;case"close":a("Closing serial port...","serial"),S.close(),a("Closed serial port","serial");break;case"forget":a("Forgetting serial ports...","serial"),S.forget().then(()=>{a("Serial ports forgotten.","serial"),j().then(()=>{p(U,N(),!0),p(d,null)})}).catch(w=>{a(`Error forgetting serial ports: ${w}`,"error")});break;default:a(`Unknown serial command: ${P}`,"error");break}break;default:a(`Unknown command: ${n}`,"error");break}}const ke=u=>{u.preventDefault();const o=document.getElementById("touchinput");o&&o.focus()};ge("echo ðŸ‘‹\\x1b[31mHello\\x1b[0mðŸ‘‹\\nðŸŒ\\x1b[32mWorld\\x1b[0mðŸŒ");let U=L(ne([]));Ce(()=>{const u=f(s).length;x.scrollTop=x.scrollHeight+0*u});var K=dt();Ue("keydown",Re,F);var O=D(K),ee=v(O);De(ee,17,()=>f(s),qe,(u,o)=>{var n=ut(),_=v(n);{var z=y=>{var b=nt(),m=v(b);H(m,()=>f(o).text),k(b),A(()=>G(b,1,Y(f(o).type),"svelte-k4so18")),I(y,b)},P=y=>{var b=at(),m=v(b,!0);k(b),A(()=>C(m,f(o).text)),I(y,b)},V=y=>{var b=ot(),m=v(b,!0);k(b),A(()=>{G(b,1,Y(f(o).type),"svelte-k4so18"),C(m,f(o).text)}),I(y,b)},W=y=>{var b=lt(),m=D(b),w=v(m);H(w,()=>i),k(m);var B=R(m,2),Le=v(B,!0);k(B),A(()=>{G(B,1,Y(f(o).type),"svelte-k4so18"),C(Le,f(o).text)}),I(y,b)};q(_,y=>{f(o).type==="output"?y(z):f(o).type==="serial"?y(P,1):f(o).type==="error"?y(V,2):y(W,!1)})}k(n),I(u,n)});var te=R(ee,2),re=v(te);{var xe=u=>{var o=ft(),n=v(o);H(n,()=>i),k(o),I(u,o)};q(re,u=>{f(c)||u(xe)})}var ie=R(re,2),Se=R(ie,2);{var Ie=u=>{var o=ct(),n=D(o),_=v(n,!0);k(n),M(2),A(()=>C(_,f(g))),I(u,o)},Be=u=>{var o=ht(),n=D(o),_=v(n,!0);k(n),M(2),A(()=>C(_,f(l))),I(u,o)};q(Se,u=>{f(c)?u(Ie):u(Be,!1)})}k(te),k(O),Ne(O,u=>x=u,()=>x);var Ee=R(O,2);{var Te=u=>{$e(u,{name:"Disconnect",onclick:()=>{p(c,!1),S?.close()},children:(o,n)=>{M();var _=Oe("Disconnect");I(o,_)},$$slots:{default:!0}})};q(Ee,u=>{f(c)&&u(Te)})}se("touchend",O,ke),se("input",ie,_e),I(t,K),pe()}Ae(["touchend","input"]);function Et(t,e){de(e,!1),Pe("metadata").setMetadata({title:"terminal",description:"A working web-based serial terminal that can be used to interact with a microcontroller or any other serial devices connected to your PC. Right from your browser!"}),Ve(),pt(t,{}),pe()}export{Et as default};
