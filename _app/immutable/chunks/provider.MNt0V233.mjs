var T=Object.defineProperty;var f=(s,e,t)=>e in s?T(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var r=(s,e,t)=>(f(s,typeof e!="symbol"?e+"":e,t),t);import{o as d,T as k,k as h,m as P,n as v,q as c,r as l,s as p,D as E,t as I,A as o}from"./register.UTOCXelZ.mjs";import{H as A}from"./provider.0Y12yiZm.mjs";class w{constructor(e,t){this.aa=e,this.ph=t,e.textTracks.onaddtrack=this.fa.bind(this),d(this.Hh.bind(this))}fa(e){const t=e.track;if(!t||m(this.aa,t))return;const i=new k({id:t.id,kind:t.kind,label:t.label,language:t.language,type:"vtt"});i[h]={track:t},i[P]=2,i[v]=!0;let n=0;const u=g=>{if(t.cues)for(let a=n;a<t.cues.length;a++)i.addCue(t.cues[a],g),n++};u(e),t.oncuechange=u,this.ph.textTracks.add(i,e),i.setMode(t.mode,e)}Hh(){var e;this.aa.textTracks.onaddtrack=null;for(const t of this.ph.textTracks){const i=(e=t[h])==null?void 0:e.track;i!=null&&i.oncuechange&&(i.oncuechange=null)}}}function m(s,e){return Array.from(s.children).find(t=>t.track===e)}class x{constructor(e,t){r(this,"Hc",(e,t)=>{this.k.delegate.R("picture-in-picture-change",{detail:e,trigger:t})});this.aa=e,this.k=t,c(this.aa,"enterpictureinpicture",this.ri.bind(this)),c(this.aa,"leavepictureinpicture",this.si.bind(this))}get active(){return document.pictureInPictureElement===this.aa}get supported(){return l(this.aa)}async enter(){return this.aa.requestPictureInPicture()}exit(){return document.exitPictureInPicture()}ri(e){this.Hc(!0,e)}si(e){this.Hc(!1,e)}}class H{constructor(e,t){r(this,"Ga","inline");this.aa=e,this.k=t,c(this.aa,"webkitpresentationmodechanged",this.wi.bind(this))}get vi(){return p(this.aa)}async ui(e){this.Ga!==e&&this.aa.webkitSetPresentationMode(e)}wi(){var t;const e=this.Ga;this.Ga=this.aa.webkitPresentationMode,(t=this.k.player)==null||t.dispatchEvent(new E("video-presentation-change",{detail:this.Ga,trigger:event})),["fullscreen","picture-in-picture"].forEach(i=>{(this.Ga===i||e===i)&&this.k.delegate.R(`${i}-change`,{detail:this.Ga===i,trigger:event})})}}class R{constructor(e){this.ti=e}get active(){return this.ti.Ga==="fullscreen"}get supported(){return this.ti.vi}async enter(){this.ti.ui("fullscreen")}async exit(){this.ti.ui("inline")}}class b{constructor(e){this.ti=e}get active(){return this.ti.Ga==="picture-in-picture"}get supported(){return this.ti.vi}async enter(){this.ti.ui("picture-in-picture")}async exit(){this.ti.ui("inline")}}class _ extends A{constructor(t,i){super(t);r(this,"$$PROVIDER_TYPE","VIDEO");r(this,"fullscreen");r(this,"pictureInPicture");if(p(t)){const n=new H(t,i);this.fullscreen=new R(n),this.pictureInPicture=new b(n)}else l(t)&&(this.pictureInPicture=new x(t,i))}get type(){return"video"}setup(t){super.setup(t),I(this.video)&&new w(this.video,t),t.textRenderers[o](this.video),d(()=>{t.textRenderers[o](null)}),this.type==="video"&&t.delegate.R("provider-setup",{detail:this})}get video(){return this.k}}export{_ as VideoProvider};
